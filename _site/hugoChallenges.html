<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>Data Carpentry in R - exercises</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />
<link rel="shortcut icon" href="favicon/favicon.ico">
<link rel="icon" sizes="16x16 32x32 64x64" href="favicon/favicon.ico">
<link rel="icon" type="image/png" sizes="196x196" href="favicon/favicon-192.png">
<link rel="icon" type="image/png" sizes="160x160" href="favicon/favicon-160.png">
<link rel="icon" type="image/png" sizes="96x96" href="favicon/favicon-96.png">
<link rel="icon" type="image/png" sizes="64x64" href="favicon/favicon-64.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon/favicon-32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon/favicon-16.png">
<link rel="apple-touch-icon" href="favicon/favicon-57.png">
<link rel="apple-touch-icon" sizes="114x114" href="favicon/favicon-114.png">
<link rel="apple-touch-icon" sizes="72x72" href="favicon/favicon-72.png">
<link rel="apple-touch-icon" sizes="144x144" href="favicon/favicon-144.png">
<link rel="apple-touch-icon" sizes="60x60" href="favicon/favicon-60.png">
<link rel="apple-touch-icon" sizes="120x120" href="favicon/favicon-120.png">
<link rel="apple-touch-icon" sizes="76x76" href="favicon/favicon-76.png">
<link rel="apple-touch-icon" sizes="152x152" href="favicon/favicon-152.png">
<link rel="apple-touch-icon" sizes="180x180" href="favicon/favicon-180.png">
<meta name="msapplication-TileColor" content="#FFFFFF">
<meta name="msapplication-TileImage" content="favicon/favicon-144.png">
<meta name="msapplication-config" content="favicon/browserconfig.xml">

<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

<script>
  $( function() {
  $( ".accordion" ).accordion({
      heightStyle: "content",
      active: false,
      collapsible: true
    });
  } );
</script>

<script>
  <!-- search menu pop-up --->
  $(function() {
    function slideToggle() {
      $("#search-box").toggle("slide", 500);
  };
  $("#search-icon").on("click", function() {
  slideToggle();
  });
  });
</script>


<!-- add  Algolia DocSearch -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<div class="container-fluid main-container">

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="00-before-we-start.html">Before we start</a>
</li>
<li>
  <a href="01-intro-to-r.html">Intro to R</a>
</li>
<li>
  <a href="02-starting-with-data.html">Starting with data</a>
</li>
<li>
  <a href="03-dplyr.html">Manipulating data frames</a>
</li>
<li>
  <a href="04-visualization-ggplot2.html">Visualizing data</a>
</li>
<li>
  <a href="05-r-and-databases.html">R and SQL</a>
</li>
<li>
  <a href="code-handout.R">Code Handout</a>
</li>
      </ul>

      <ul class="nav navbar-nav navbar-right">
	<li class="search">
	  <input id="search-box" type="text"  placeholder="Search...">
	  <input type="submit">
	</li>
	<li class="search">
	  <span id ="search-icon"><i class="fa fa-search fa-lg"></i></span>
	</li>
        <li>
	  <a href="https://github.com/datacarpentry/R-ecology-lesson">
	    <span class="fa fa-github fa-lg"></span>
	  </a>
	</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data Carpentry in R - exercises</h1>

</div>


<p><a href="https://datacarpentry.org/R-ecology-lesson/index.html">back to course materials</a></p>
<div id="intro" class="section level1">
<h1><span class="header-section-number">1</span> Intro</h1>
<hr />
<div id="variables" class="section level2">
<h2><span class="header-section-number">1.1</span> Variables</h2>
<p>What is the value of <code>mass_index</code> after running these commands?</p>
<pre><code>mass &lt;- 47.5
age  &lt;- 100
mass_index &lt;- mass/age
mass &lt;- mass * 2.0</code></pre>
<p>What type of vector do you get in each of the following cases (hint: use <code>class()</code>)?</p>
<pre><code>num_char &lt;- c(1, 2, 3, &quot;a&quot;)
num_logical &lt;- c(1, 2, 3, TRUE)
char_logical &lt;- c(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, TRUE)
tricky &lt;- c(1, 2, 3, &quot;4&quot;)</code></pre>
<hr />
</div>
<div id="conditional-subsetting" class="section level2">
<h2><span class="header-section-number">1.2</span> Conditional subsetting</h2>
<p>Using this vector:</p>
<pre><code>heights &lt;- c(63, 69, 60, 65, NA, 68, 61, 70, 61, 59, 64, 69, 63, 63, NA, 72, 65, 64, 70, 63, 65)</code></pre>
<ul>
<li>create a new vector with missing values removed</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">heights_no_na &lt;-<span class="st"> </span>heights[<span class="op">!</span><span class="kw">is.na</span>(heights)]</code></pre></div>
<ul>
<li>calculate the median of heights</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">median</span>(heights, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)
<span class="co"># or</span>
<span class="kw">median</span>(heights_no_na)</code></pre></div>
<ul>
<li>calculate how many values are above 67</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(heights_no_na <span class="op">&gt;</span><span class="st"> </span><span class="dv">67</span>)</code></pre></div>
<hr />
</div>
<div id="basic-data.frame-manipulation" class="section level2">
<h2><span class="header-section-number">1.3</span> Basic <code>data.frame</code> manipulation</h2>
<ul>
<li>How many rows and columns does <code>surveys</code> have? (hint: functions <code>ncol()</code> and <code>nrow()</code>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(surveys)
<span class="kw">ncol</span>(surveys)</code></pre></div>
<ul>
<li>What type of variables do you have in the table? (hint: function <code>glimpse()</code>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(surveys)</code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>How many missing values of weight are there? (remember you can use <code>sum()</code> on a logical vector)
<ul>
<li>extra: what proportion of values are missing?</li>
</ul></li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(<span class="kw">is.na</span>(surveys<span class="op">$</span>weight))

<span class="co"># Extra: divide by total number of observations</span>
<span class="kw">sum</span>(<span class="kw">is.na</span>(surveys<span class="op">$</span>weight))<span class="op">/</span><span class="kw">nrow</span>(surveys)</code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>How many unique genera were sampled? (hint: functions <code>unique()</code> and <code>length()</code>)</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(surveys<span class="op">$</span>genus))</code></pre></div>
</div>
</div>
<div id="manipulating-data-frames-with-dplyr" class="section level1">
<h1><span class="header-section-number">2</span> Manipulating data frames with <code>dplyr</code></h1>
<hr />
<div id="filter-and-select" class="section level2">
<h2><span class="header-section-number">2.1</span> filter and select</h2>
<p>Using pipes, subset the surveys data to include animals collected before 1995 and retain only the columns year, sex, and weight.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_pre1995 &lt;-<span class="st"> </span>surveys <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(year <span class="op">&lt;</span><span class="st"> </span><span class="dv">1995</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">select</span>(year, sex, weight)</code></pre></div>
<p>The answer should have 21486 rows of data.</p>
<hr />
</div>
<div id="mutate-filter-and-select" class="section level2">
<h2><span class="header-section-number">2.2</span> mutate, filter and select</h2>
<p>Create a new data frame from the surveys data that meets the following criteria: contains only the <code>species_id</code> column and a new column called <code>hindfoot_half</code> containing values that are half the <code>hindfoot_length</code> values. In this <code>hindfoot_half</code> column, there are no <code>NAs</code> and all values are less than 30.</p>
<p>Hint: think about how the commands should be ordered to produce this data frame!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_hindfoot_half &lt;-<span class="st"> </span>surveys <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(hindfoot_length)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">hindfoot_half =</span> hindfoot_length <span class="op">/</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(hindfoot_half <span class="op">&lt;</span><span class="st"> </span><span class="dv">30</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(species_id, hindfoot_half)</code></pre></div>
<p>The answer should have 31436 rows and 2 columns.</p>
<hr />
</div>
<div id="grouped-summaries" class="section level2">
<h2><span class="header-section-number">2.3</span> grouped summaries</h2>
<ul>
<li>How many animals were caught in each <code>plot_type</code> surveyed?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">count</span>(plot_type) </code></pre></div>
<ul>
<li>Make a summary table with the mean, minimum and maximum hindfoot length of each species. Include the total number of individuals observed as well as the number of those individuals that had data for this variable.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(species_id) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(
    <span class="dt">mean_hindfoot_length =</span> <span class="kw">mean</span>(hindfoot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">min_hindfoot_length =</span> <span class="kw">min</span>(hindfoot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">max_hindfoot_length =</span> <span class="kw">max</span>(hindfoot_length, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),
    <span class="dt">n =</span> <span class="kw">n</span>(),
    <span class="dt">n_hindfoot =</span> <span class="kw">sum</span>(<span class="op">!</span><span class="kw">is.na</span>(hindfoot_length))
  )</code></pre></div>
<ul>
<li>What was the heaviest animal measured in each year? Return the columns <code>year</code>, <code>genus</code>, <code>species_id</code> and <code>weight</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(weight)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(weight <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(weight)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(year, genus, species, weight) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(year)</code></pre></div>
<hr />
</div>
<div id="data-cleaning" class="section level2">
<h2><span class="header-section-number">2.4</span> Data cleaning</h2>
<ul>
<li>Create a new data frame called <code>surveys_complete</code>, which:
<ul>
<li>has no missing values for <code>weight</code>, <code>hindfoot_length</code> and <code>sex</code></li>
<li>contains only species that were measured in at least 50 individuals</li>
</ul></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete &lt;-<span class="st"> </span>surveys <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(weight) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(sex) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(hindfoot_length))

common_species &lt;-<span class="st"> </span>surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">count</span>(species_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(n <span class="op">&gt;=</span><span class="st"> </span><span class="dv">50</span>)

surveys_complete &lt;-<span class="st"> </span>surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(species_id <span class="op">%in%</span><span class="st"> </span>common_species<span class="op">$</span>species_id)</code></pre></div>
<p>The final data frame should have 30463 rows.</p>
<ul>
<li>Optional: save the new table as a CSV file in the <code>data_output</code> folder of your project directory.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write_csv</span>(surveys_complete, <span class="st">&quot;data_output/surveys_complete.csv&quot;</span>)</code></pre></div>
</div>
</div>
<div id="plotting-with-ggplot2" class="section level1">
<h1><span class="header-section-number">3</span> Plotting with <code>ggplot2</code></h1>
<hr />
<div id="distributions" class="section level2">
<h2><span class="header-section-number">3.1</span> distributions</h2>
<p>Boxplots are useful summaries, but hide the shape of the distribution. For example, if the distribution is bimodal, we would not see it in a boxplot. An alternative to the boxplot is the violin plot, where the shape (of the density of points) is drawn.</p>
<ul>
<li>Use <code>geom_violin()</code> to create violin plots of weight distributions for each <code>genus</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(genus, weight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>()</code></pre></div>
<ul>
<li>Some individuals are much heavier than others. Using a log scale in this case would help. Try adding a “scale” layer with <code>scale_y_log10()</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(genus, weight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<ul>
<li>Can you overlay a boxplot with outliers removed (check <code>?geom_boxplot</code> help)?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(genus, weight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<ul>
<li>Try and recreate the picture below, showing the distribution of weights by <code>species_id</code>, with violin plots coloured by <code>genus</code>.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(species_id, weight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_violin</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> genus)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<hr />
</div>
<div id="two-categorical-variables" class="section level2">
<h2><span class="header-section-number">3.2</span> Two categorical variables</h2>
<p>Use the <code>count()</code> function to get the number of individuals of each genus in each plot type surveyed and then use that table to make a visual representation like the one shown below.</p>
<p>(hint: try the <code>size</code> aesthetic with <code>geom_point()</code>)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">count</span>(genus, plot_type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(genus, plot_type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">size =</span> n)) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Genus&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Plot Type&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<hr />
</div>
<div id="line-plots" class="section level2">
<h2><span class="header-section-number">3.3</span> Line plots</h2>
<p>We want to explore if the species diversity (number of different species) changed across the years in different plot treatments (<code>plot_type</code>).</p>
<ul>
<li>Make a new table called <code>yearly_diversity</code>, with the number of <em>distinct</em> <code>species_id</code> sampled in each year and plot type.</li>
</ul>
<p>(hint: use the function <code>n_distinct()</code> inside the <code>summarise()</code> function)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yearly_diversity &lt;-<span class="st"> </span>surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, plot_type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">n_species =</span> <span class="kw">n_distinct</span>(species_id)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>()</code></pre></div>
<ul>
<li>Using the new table, try and reproduce the plot below</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">yearly_diversity <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, n_species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> plot_type)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;Plot Type&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# species&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<ul>
<li>Update your summary table by also including information about sex (i.e. species diversity per <code>year</code>, <code>plot_type</code> and <code>sex</code>). Can you think of ways to change your previous plot to also visualise this extra information?</li>
</ul>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<hr />
</div>
<div id="factors-to-improve-visualisation" class="section level2">
<h2><span class="header-section-number">3.4</span> Factors to improve visualisation</h2>
<ul>
<li>Using your <code>yearly_diversity</code> table, can you recreate the plot below, ensuring the order of the <code>plot_type</code> facets is as shown?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a vector with treatments in desired order</span>
## this is optional, but makes it easier to read the code
plot_type_order &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Control&quot;</span>, 
                     <span class="st">&quot;Short-term Krat Exclosure&quot;</span>, <span class="st">&quot;Long-term Krat Exclosure&quot;</span>,
                     <span class="st">&quot;Rodent Exclosure&quot;</span>, <span class="st">&quot;Spectab exclosure&quot;</span>)

<span class="co"># Factorise the `plot_type` variable with custom levels before plotting</span>
yearly_diversity <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">plot_type =</span> <span class="kw">factor</span>(plot_type, <span class="dt">levels =</span> plot_type_order)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, n_species)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;Plot Type&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;# species&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>plot_type)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
</div>
</div>
<div id="optional-advanced-plotting-exercises" class="section level1">
<h1><span class="header-section-number">4</span> Optional (advanced) plotting exercises</h1>
<hr />
<div id="line-plots-1" class="section level2">
<h2><span class="header-section-number">4.1</span> Line plots</h2>
<p>Use line plots to help you explore these questions:</p>
<ul>
<li>How did the average weight of all species change across the years?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wgt =</span> <span class="kw">mean</span>(weight, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, mean_wgt)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average biomass (g)&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<ul>
<li>Was it different for males and females?</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wgt =</span> <span class="kw">mean</span>(weight, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, mean_wgt, <span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average biomass (g)&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<ul>
<li>What about between different <code>plot_type</code>? (hint: use facetting to help you)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, sex, plot_type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wgt =</span> <span class="kw">mean</span>(weight, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, mean_wgt, <span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>plot_type) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average biomass (g)&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
<ul>
<li>Bonus: Try and add a “ribbon” which shows the mean +/- 2*SEM (standard error of the mean, calculated as the standard deviation divided by the square root of the number of observations)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, sex, plot_type) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wgt =</span> <span class="kw">mean</span>(weight),
            <span class="dt">se_wgt =</span> <span class="kw">sd</span>(weight)<span class="op">/</span><span class="kw">sqrt</span>(<span class="kw">n</span>())) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, mean_wgt, <span class="dt">colour =</span> sex)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> mean_wgt <span class="op">-</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>se_wgt, <span class="dt">ymax =</span> mean_wgt <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span>se_wgt, <span class="dt">fill =</span> sex), 
              <span class="dt">alpha =</span> <span class="fl">0.3</span>, <span class="dt">colour =</span> <span class="ot">NA</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">facet_wrap</span>( <span class="op">~</span><span class="st"> </span>plot_type) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Average biomass (g)&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<hr />
</div>
<div id="reshaping-data" class="section level2">
<h2><span class="header-section-number">4.2</span> Reshaping data</h2>
<ul>
<li>Make a scatterplot to explore the correlation between average male and female weights per species in each <code>plot_type</code> surveyed. (hint: add a x=y identity line using <code>geom_abline()</code>)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(species_id, plot_type, sex) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_wgt =</span> <span class="kw">mean</span>(weight)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(sex, mean_wgt) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(M, F)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_abline</span>(<span class="dt">linetype =</span> <span class="dv">2</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(plot_type))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_x_log10</span>() <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_log10</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Male&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Female&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Plot type&quot;</span>)</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
<hr />
</div>
<div id="reordering-factors" class="section level2">
<h2><span class="header-section-number">4.3</span> Reordering factors</h2>
<ul>
<li>Make a boxplot similar to the one below, showing the hindfoot length distribution, with the x-axis sorted by mean weight. (hint: create a colum with the mean weight per species and then use the function <code>reorder()</code> to factorise the x-axis variable)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(species_id) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mean_weight =</span> <span class="kw">mean</span>(weight)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">species_id =</span> <span class="kw">reorder</span>(species_id, mean_weight)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(species_id, hindfoot_length)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">log10</span>(mean_weight))) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_fill_viridis_c</span>() <span class="co"># &quot;viridis&quot; is a colour-blind pallete</span></code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-31-1.png" width="672" /></p>
<hr />
</div>
<div id="combining-datasets" class="section level2">
<h2><span class="header-section-number">4.4</span> Combining datasets</h2>
<p>In a publication from <a href="https://www.journals.uchicago.edu/doi/10.1086/592402">Ernest et al. 2017</a> some species where classified according to their habitat preferences.</p>
<p>Read this information into your R session using the following command:</p>
<pre><code>habitat_pref &lt;- read_csv(&quot;https://raw.githubusercontent.com/tavareshugo/data_carpentry_extras/master/slides_with_exercises/species_habitat_affinities_Ernest2017.csv&quot;)</code></pre>
<ul>
<li>How many of these species are contained in your <code>surveys_complete</code> dataset? (hint: the function <code>paste()</code> might be useful)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sum</span>(habitat_pref<span class="op">$</span>species <span class="op">%in%</span><span class="st"> </span><span class="kw">paste</span>(surveys_complete<span class="op">$</span>genus, surveys_complete<span class="op">$</span>species))</code></pre></div>
<ul>
<li>Make a boxplot like the one below, showing the weight distribution of each species that has habitat affinity information. (hint: look at the help for <code>?facet_grid</code> to see how to make the panels scales and spacing adjust to the data)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">species_name =</span> <span class="kw">paste</span>(genus, species)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">inner_join</span>(habitat_pref, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;species_name&quot;</span> =<span class="st"> &quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(species_id, weight)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> genus)) <span class="op">+</span>
<span class="st">  </span><span class="kw">facet_grid</span>(sex <span class="op">~</span><span class="st"> </span>habitat, <span class="dt">scale =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">space =</span> <span class="st">&quot;free_x&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_y_log10</span>()</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<ul>
<li>Plot the change in abundance across the years for species with different habitat affinities (include those species with no habitat information as well).
<ul>
<li>Abundance = number of individuals per hectare</li>
<li>Each plot is 0.25ha</li>
</ul></li>
</ul>
<p>(don’t worry too much about getting the exact look of the graph below. But if you do want to get a similar look, try and do some web search! E.g. “how to change legend position in ggplot2”)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">surveys_complete <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">species_name =</span> <span class="kw">paste</span>(genus, species)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">left_join</span>(habitat_pref, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;species_name&quot;</span> =<span class="st"> &quot;species&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(year, habitat) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summarise</span>(<span class="dt">abundance =</span> <span class="kw">n</span>()<span class="op">/</span>(<span class="fl">0.25</span><span class="op">*</span><span class="kw">n_distinct</span>(plot_id))) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(year, abundance)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> habitat)) <span class="op">+</span>
<span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Abundance (# individuals/ha)&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;Habitat preference&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">scale_colour_viridis_d</span>(<span class="dt">na.value =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">legend.justification =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="hugoChallenges_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
</div>
</div>

<hr/>

<p><a href="http://datacarpentry.org/">Data Carpentry</a>,
  2018. <a href="LICENSE.html">License</a>. <a href="CONTRIBUTING.html">Contributing</a>. <br/>
  Questions?  Feedback?
  Please <a href="https://github.com/datacarpentry/R-ecology-lesson/issues/new">file
  an issue on GitHub</a>. <br/> On
  Twitter: <a href="https://twitter.com/datacarpentry">@datacarpentry</a></p>

<!--  Algolia DocSearch -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
<script type="text/javascript"> docsearch({
 apiKey: '4c64cef535ab2b7c8d1b73ed13f283e1',
 indexName: 'datacarpentry',
 inputSelector: '#search-box',
 debug: false // Set debug to true if you want to inspect the dropdown
});
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
